
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.3.0, mkdocs-material-8.2.8">
    
    
      
        <title>Neural Network Introduction - Machine Learning Tutorials</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.644de097.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.e6a45f82.min.css">
        
      
    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#neural-net-introduction" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Machine Learning Tutorials" class="md-header__button md-logo" aria-label="Machine Learning Tutorials" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Machine Learning Tutorials
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Neural Network Introduction
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Machine Learning Tutorials" class="md-nav__button md-logo" aria-label="Machine Learning Tutorials" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    Machine Learning Tutorials
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../linear/" class="md-nav__link">
        Linear Regression
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../logistic/" class="md-nav__link">
        Logistic Regression
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../tree/" class="md-nav__link">
        Decision Tree
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../svm/" class="md-nav__link">
        Support Vector Machine
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../nnc/" class="md-nav__link">
        Nearest Neighbours
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../perceptron/" class="md-nav__link">
        Perceptron
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../clustering/" class="md-nav__link">
        Clustering
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Neural Network Introduction
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Neural Network Introduction
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#intall-tensorflow" class="md-nav__link">
    Intall Tensorflow
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#load-data" class="md-nav__link">
    Load data
  </a>
  
    <nav class="md-nav" aria-label="Load data">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#what-are-the-shape-of-the-data" class="md-nav__link">
    What are the shape of the data?
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#data-visualization" class="md-nav__link">
    Data Visualization
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#preprocess-data" class="md-nav__link">
    Preprocess data
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#data-normalization" class="md-nav__link">
    Data Normalization
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prepare-labels" class="md-nav__link">
    Prepare Labels
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#design-neural-network-architecture" class="md-nav__link">
    Design neural network architecture
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configure-model" class="md-nav__link">
    Configure model
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#train" class="md-nav__link">
    Train!
  </a>
  
    <nav class="md-nav" aria-label="Train!">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#plot-history" class="md-nav__link">
    Plot History
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#performing-inference" class="md-nav__link">
    Performing Inference
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../feature/feature/" class="md-nav__link">
        Neural Network-FeatureScaling
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../callback/callback/" class="md-nav__link">
        Neural Network-Callbacks
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../tuning/tuning/" class="md-nav__link">
        Neural Network-Tuning
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../cnn/cnn/" class="md-nav__link">
        Convolutional Neural Network
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../lstm/lstm/" class="md-nav__link">
        LSTM-Introduction
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#intall-tensorflow" class="md-nav__link">
    Intall Tensorflow
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#load-data" class="md-nav__link">
    Load data
  </a>
  
    <nav class="md-nav" aria-label="Load data">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#what-are-the-shape-of-the-data" class="md-nav__link">
    What are the shape of the data?
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#data-visualization" class="md-nav__link">
    Data Visualization
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#preprocess-data" class="md-nav__link">
    Preprocess data
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#data-normalization" class="md-nav__link">
    Data Normalization
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prepare-labels" class="md-nav__link">
    Prepare Labels
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#design-neural-network-architecture" class="md-nav__link">
    Design neural network architecture
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configure-model" class="md-nav__link">
    Configure model
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#train" class="md-nav__link">
    Train!
  </a>
  
    <nav class="md-nav" aria-label="Train!">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#plot-history" class="md-nav__link">
    Plot History
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#performing-inference" class="md-nav__link">
    Performing Inference
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                


<h1 id="neural-net-introduction">Neural Net : Introduction</h1>
<p>For classifying MNIST digits. </p>
<h4 id="intall-tensorflow">Intall Tensorflow</h4>
<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%;"><span></span><code><span style="color: #0099FF; font-style: italic">#pip install tensorflow==2.0.0-beta0</span>
<span style="color: #0099FF; font-style: italic">#pip install --upgrade tensorflow==2.0.0-beta0</span>
</code></pre></div>

<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%;"><span></span><code><span style="color: #006699; font-weight: bold">import</span> <span style="color: #00CCFF; font-weight: bold">tensorflow</span> <span style="color: #006699; font-weight: bold">as</span> <span style="color: #00CCFF; font-weight: bold">tf</span>
<span style="color: #006699; font-weight: bold">from</span> <span style="color: #00CCFF; font-weight: bold">tensorflow</span> <span style="color: #006699; font-weight: bold">import</span> keras  <span style="color: #0099FF; font-style: italic"># tf.keras</span>
<span style="color: #006699; font-weight: bold">import</span> <span style="color: #00CCFF; font-weight: bold">seaborn</span> <span style="color: #006699; font-weight: bold">as</span> <span style="color: #00CCFF; font-weight: bold">sns</span>
<span style="color: #006699; font-weight: bold">import</span> <span style="color: #00CCFF; font-weight: bold">matplotlib</span> <span style="color: #006699; font-weight: bold">as</span> <span style="color: #00CCFF; font-weight: bold">mpl</span>
<span style="color: #006699; font-weight: bold">import</span> <span style="color: #00CCFF; font-weight: bold">matplotlib.pyplot</span> <span style="color: #006699; font-weight: bold">as</span> <span style="color: #00CCFF; font-weight: bold">plt</span>
<span style="color: #006699; font-weight: bold">import</span> <span style="color: #00CCFF; font-weight: bold">numpy</span> <span style="color: #006699; font-weight: bold">as</span> <span style="color: #00CCFF; font-weight: bold">np</span>
<span style="color: #006699; font-weight: bold">import</span> <span style="color: #00CCFF; font-weight: bold">os</span>
<span style="color: #006699; font-weight: bold">import</span> <span style="color: #00CCFF; font-weight: bold">pandas</span> <span style="color: #006699; font-weight: bold">as</span> <span style="color: #00CCFF; font-weight: bold">pd</span>
<span style="color: #006699; font-weight: bold">import</span> <span style="color: #00CCFF; font-weight: bold">sklearn</span>
<span style="color: #006699; font-weight: bold">import</span> <span style="color: #00CCFF; font-weight: bold">sys</span>
<span style="color: #006699; font-weight: bold">import</span> <span style="color: #00CCFF; font-weight: bold">time</span>
</code></pre></div>

<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%;"><span></span><code>sns<span style="color: #555555">.</span>set()
<span style="color: #555555">%</span>matplotlib inline
<span style="color: #555555">%</span>load_ext tensorboard
</code></pre></div>

<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%;"><span></span><code>The tensorboard extension is already loaded. To reload it, use:
  %reload_ext tensorboard
</code></pre></div>

<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%;"><span></span><code><span style="color: #336666">print</span>(<span style="color: #CC3300">&quot;python&quot;</span>, sys<span style="color: #555555">.</span>version)
<span style="color: #006699; font-weight: bold">for</span> module <span style="color: #000000; font-weight: bold">in</span> mpl, np, pd, sklearn, tf, keras:
    <span style="color: #336666">print</span>(module<span style="color: #555555">.</span><span style="color: #003333">__name__</span>, module<span style="color: #555555">.</span>__version__)
</code></pre></div>

<div class="codehilite" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code>python 3.7.1 (default, Dec 14 2018, 13:28:58) 
[Clang 4.0.1 (tags/RELEASE_401/final)]
matplotlib 3.0.2
numpy 1.15.4
pandas 0.23.4
sklearn 0.20.1
tensorflow 2.0.0-beta0
tensorflow.python.keras.api._v2.keras 2.2.4-tf
</code></pre></div>

<h4 id="load-data">Load data</h4>
<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%;"><span></span><code>(X_train, y_train), (X_valid, y_valid) <span style="color: #555555">=</span> keras<span style="color: #555555">.</span>datasets<span style="color: #555555">.</span>mnist<span style="color: #555555">.</span>load_data()
</code></pre></div>

<h5 id="what-are-the-shape-of-the-data">What are the shape of the data?</h5>
<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%;"><span></span><code><span style="color: #336666">print</span>(X_train<span style="color: #555555">.</span>shape, y_train<span style="color: #555555">.</span>shape,X_valid<span style="color: #555555">.</span>shape, y_valid<span style="color: #555555">.</span>shape)
</code></pre></div>

<div class="codehilite" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code>(60000, 28, 28) (60000,) (10000, 28, 28) (10000,)
</code></pre></div>

<ul>
<li>There are 60,000 Train data which are 28 by 28 pixcel images and </li>
<li>There are 10,000 Train data which are also 28 by 28 pixcel images</li>
</ul>
<h4 id="data-visualization">Data Visualization</h4>
<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%;"><span></span><code><span style="color: #006699; font-weight: bold">import</span> <span style="color: #00CCFF; font-weight: bold">matplotlib.pyplot</span> <span style="color: #006699; font-weight: bold">as</span> <span style="color: #00CCFF; font-weight: bold">plt</span>
<span style="color: #555555">%</span>matplotlib inline

plt<span style="color: #555555">.</span>figure(figsize <span style="color: #555555">=</span> [<span style="color: #FF6600">10</span>,<span style="color: #FF6600">8</span>])
<span style="color: #006699; font-weight: bold">for</span> i <span style="color: #000000; font-weight: bold">in</span> <span style="color: #336666">range</span>(<span style="color: #FF6600">1</span>,<span style="color: #FF6600">51</span>):
    plt<span style="color: #555555">.</span>subplot(<span style="color: #FF6600">5</span>,<span style="color: #FF6600">10</span>,i)
    plt<span style="color: #555555">.</span>imshow(X_train[i]<span style="color: #555555">.</span>reshape(<span style="color: #FF6600">28</span>,<span style="color: #FF6600">28</span>))
plt<span style="color: #555555">.</span>show()
</code></pre></div>

<p><img alt="png" src="../output_13_0.png" /></p>
<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%;"><span></span><code>y_train[<span style="color: #FF6600">1</span>:<span style="color: #FF6600">26</span>]
</code></pre></div>

<div class="codehilite" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code>array([0, 4, 1, 9, 2, 1, 3, 1, 4, 3, 5, 3, 6, 1, 7, 2, 8, 6, 9, 4, 0, 9,
       1, 1, 2], dtype=uint8)
</code></pre></div>

<h4 id="preprocess-data">Preprocess data</h4>
<p>We flaten the data (from 28 by 28 to 784) before it is feed into the model. We can also create a layer as a front layer to perform this flattening step.</p>
<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%;"><span></span><code>X_train <span style="color: #555555">=</span> X_train<span style="color: #555555">.</span>reshape(<span style="color: #FF6600">60000</span>, <span style="color: #FF6600">784</span>)<span style="color: #555555">.</span>astype(<span style="color: #CC3300">&#39;float32&#39;</span>)
X_valid <span style="color: #555555">=</span> X_valid<span style="color: #555555">.</span>reshape(<span style="color: #FF6600">10000</span>, <span style="color: #FF6600">784</span>)<span style="color: #555555">.</span>astype(<span style="color: #CC3300">&#39;float32&#39;</span>)
</code></pre></div>

<h4 id="data-normalization">Data Normalization</h4>
<p>This step converts the pixcel value ranging from 0 to 255 into 0 to 1.</p>
<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%;"><span></span><code>X_train <span style="color: #555555">/=</span> <span style="color: #FF6600">255</span>
X_valid <span style="color: #555555">/=</span> <span style="color: #FF6600">255</span>
</code></pre></div>

<h4 id="prepare-labels">Prepare Labels</h4>
<p>We convert label 1,2,3,4,5,6,7,8,9 in label vectors</p>
<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%;"><span></span><code>n_classes <span style="color: #555555">=</span> <span style="color: #FF6600">10</span>
y_train <span style="color: #555555">=</span> keras<span style="color: #555555">.</span>utils<span style="color: #555555">.</span>to_categorical(y_train, n_classes)
y_valid <span style="color: #555555">=</span> keras<span style="color: #555555">.</span>utils<span style="color: #555555">.</span>to_categorical(y_valid, n_classes)
</code></pre></div>

<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%;"><span></span><code>y_train[<span style="color: #FF6600">1</span>:<span style="color: #FF6600">16</span>]
</code></pre></div>

<div class="codehilite" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code>array([[1., 0., 0., 0., 0., 0., 0., 0., 0., 0.],
       [0., 0., 0., 0., 1., 0., 0., 0., 0., 0.],
       [0., 1., 0., 0., 0., 0., 0., 0., 0., 0.],
       [0., 0., 0., 0., 0., 0., 0., 0., 0., 1.],
       [0., 0., 1., 0., 0., 0., 0., 0., 0., 0.],
       [0., 1., 0., 0., 0., 0., 0., 0., 0., 0.],
       [0., 0., 0., 1., 0., 0., 0., 0., 0., 0.],
       [0., 1., 0., 0., 0., 0., 0., 0., 0., 0.],
       [0., 0., 0., 0., 1., 0., 0., 0., 0., 0.],
       [0., 0., 0., 1., 0., 0., 0., 0., 0., 0.],
       [0., 0., 0., 0., 0., 1., 0., 0., 0., 0.],
       [0., 0., 0., 1., 0., 0., 0., 0., 0., 0.],
       [0., 0., 0., 0., 0., 0., 1., 0., 0., 0.],
       [0., 1., 0., 0., 0., 0., 0., 0., 0., 0.],
       [0., 0., 0., 0., 0., 0., 0., 1., 0., 0.]], dtype=float32)
</code></pre></div>

<h4 id="design-neural-network-architecture">Design neural network architecture</h4>
<p><img alt="img" src="https://datafiction.github.io/docs/ml/perceptron/pic1/perceptron.jpg" /></p>
<p>Demo: https://datafiction.github.io/docs/ml/perceptron/dlnd-your-first-neural-network/</p>
<p>After the pixels are flattened, the network consists of a sequence of two <code>tf.keras.layers.Dense</code> layers. These are densely connected, or fully connected, neural layers. The first Dense layer has 64 nodes (or neurons). The second (and last) layer is a 10-node softmax layer that returns an array of 10 probability scores that sum to 1. Each node contains a score that indicates the probability that the current image belongs to one of the 10 classes.</p>
<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%;"><span></span><code>model
   = keras.models.sequential([
       keras.layer.layerType(parameters...),
       keras.layer.layerType(parameters...),
       keras.layer.layerType(parameters...),
       keras.layer.layerType(parameters...)
   ])  
</code></pre></div>

<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%;"><span></span><code>model <span style="color: #555555">=</span> keras<span style="color: #555555">.</span>models<span style="color: #555555">.</span>Sequential([


    keras<span style="color: #555555">.</span>layers<span style="color: #555555">.</span>Dense(<span style="color: #FF6600">64</span>,\
                       activation<span style="color: #555555">=</span><span style="color: #CC3300">&#39;sigmoid&#39;</span>,\
                       input_shape<span style="color: #555555">=</span>(<span style="color: #FF6600">784</span>,)),

    keras<span style="color: #555555">.</span>layers<span style="color: #555555">.</span>Dense(<span style="color: #FF6600">10</span>,\
                       activation<span style="color: #555555">=</span><span style="color: #CC3300">&#39;softmax&#39;</span>)

])
</code></pre></div>

<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%;"><span></span><code>model<span style="color: #555555">.</span>summary()
</code></pre></div>

<div class="codehilite" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code>Model: &quot;sequential_1&quot;
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_2 (Dense)              (None, 64)                50240     
_________________________________________________________________
dense_3 (Dense)              (None, 10)                650       
=================================================================
Total params: 50,890
Trainable params: 50,890
Non-trainable params: 0
_________________________________________________________________
</code></pre></div>

<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%;"><span></span><code>(<span style="color: #FF6600">784</span><span style="color: #555555">*</span><span style="color: #FF6600">64</span>)<span style="color: #555555">+</span> <span style="color: #FF6600">64</span>, (<span style="color: #FF6600">64</span><span style="color: #555555">*</span><span style="color: #FF6600">10</span>)<span style="color: #555555">+</span><span style="color: #FF6600">10</span>
</code></pre></div>

<div class="codehilite" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code>(50240, 650)
</code></pre></div>

<h4 id="configure-model">Configure model</h4>
<p>Before the model is ready for training, it needs a few more settings. These are added during the model's compile step:</p>
<ul>
<li><code>Loss function</code> —This measures how accurate the model is during training. You want to minimize this function to "steer" the model in the right direction.</li>
<li><code>Optimizer</code> —This is how the model is updated based on the data it sees and its loss function.</li>
<li><code>Metrics</code> —Used to monitor the training and testing steps. The following example uses accuracy, the fraction of the images that are correctly classified.</li>
</ul>
<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%;"><span></span><code>model<span style="color: #555555">.</span>compile(loss<span style="color: #555555">=</span><span style="color: #CC3300">&#39;categorical_crossentropy&#39;</span>,\
              optimizer<span style="color: #555555">=</span><span style="color: #CC3300">&#39;adam&#39;</span>,\
              metrics<span style="color: #555555">=</span>[<span style="color: #CC3300">&#39;accuracy&#39;</span>])
</code></pre></div>

<h4 id="train">Train!</h4>
<p>Now your model is ready to be trained. Call its <code>fit()</code> method, passing it the input features (<code>X_train</code>) and the target classes (<code>y_train</code>). Set <code>epochs=10</code> (or else it will just run for a single epoch). You can also (optionally) pass the validation data by setting <code>validation_data=(X_valid, y_valid)</code>. If you do, Keras will compute the loss and the additional metrics (the accuracy in this case) on the validation set at the end of each epoch. If the performance on the training set is much better than on the validation set, your model is probably overfitting the training set (or there is a bug, such as a mismatch between the training set and the validation set).
<strong>Note</strong>: the <code>fit()</code> method will return a <code>History</code> object containing training stats. Make sure to preserve it (<code>history = model.fit(...)</code>).</p>
<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%;"><span></span><code>history <span style="color: #555555">=</span> model<span style="color: #555555">.</span>fit(X_train, y_train,\
          batch_size<span style="color: #555555">=</span><span style="color: #FF6600">128</span>,\
          epochs<span style="color: #555555">=</span><span style="color: #FF6600">10</span>,\
          verbose<span style="color: #555555">=</span><span style="color: #FF6600">1</span>,\
          validation_data<span style="color: #555555">=</span>(X_valid, y_valid))
</code></pre></div>

<div class="codehilite" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code>Train on 60000 samples, validate on 10000 samples
Epoch 1/10
60000/60000 [==============================] - 1s 15us/sample - loss: 0.1051 - accuracy: 0.9707 - val_loss: 0.1200 - val_accuracy: 0.9641
Epoch 2/10
60000/60000 [==============================] - 1s 15us/sample - loss: 0.0973 - accuracy: 0.9732 - val_loss: 0.1133 - val_accuracy: 0.9649
Epoch 3/10
60000/60000 [==============================] - 1s 15us/sample - loss: 0.0904 - accuracy: 0.9752 - val_loss: 0.1092 - val_accuracy: 0.9672
Epoch 4/10
60000/60000 [==============================] - 1s 15us/sample - loss: 0.0843 - accuracy: 0.9773 - val_loss: 0.1047 - val_accuracy: 0.9689
Epoch 5/10
60000/60000 [==============================] - 1s 15us/sample - loss: 0.0786 - accuracy: 0.9789 - val_loss: 0.1019 - val_accuracy: 0.9680
Epoch 6/10
60000/60000 [==============================] - 1s 15us/sample - loss: 0.0737 - accuracy: 0.9800 - val_loss: 0.0997 - val_accuracy: 0.9697
Epoch 7/10
60000/60000 [==============================] - 1s 16us/sample - loss: 0.0689 - accuracy: 0.9821 - val_loss: 0.0976 - val_accuracy: 0.9702
Epoch 8/10
60000/60000 [==============================] - 1s 14us/sample - loss: 0.0648 - accuracy: 0.9831 - val_loss: 0.0957 - val_accuracy: 0.9706
Epoch 9/10
60000/60000 [==============================] - 1s 14us/sample - loss: 0.0609 - accuracy: 0.9845 - val_loss: 0.0930 - val_accuracy: 0.9713
Epoch 10/10
60000/60000 [==============================] - 1s 14us/sample - loss: 0.0574 - accuracy: 0.9849 - val_loss: 0.0922 - val_accuracy: 0.9723
</code></pre></div>

<h5 id="plot-history">Plot History</h5>
<p>Try running <code>pd.DataFrame(history.history).plot()</code> to plot the learning curves. To make the graph more readable, you can also set <code>figsize=(8, 5)</code>, call <code>plt.grid(True)</code> and <code>plt.gca().set_ylim(0, 1)</code>.</p>
<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%;"><span></span><code><span style="color: #006699; font-weight: bold">def</span> <span style="color: #CC00FF">plot_learning_curves</span>(history):
    pd<span style="color: #555555">.</span>DataFrame(history<span style="color: #555555">.</span>history)<span style="color: #555555">.</span>plot(figsize<span style="color: #555555">=</span>(<span style="color: #FF6600">8</span>, <span style="color: #FF6600">5</span>))
    plt<span style="color: #555555">.</span>grid(<span style="color: #006699; font-weight: bold">True</span>)
    plt<span style="color: #555555">.</span>gca()<span style="color: #555555">.</span>set_ylim(<span style="color: #FF6600">0</span>, <span style="color: #FF6600">1</span>)
    plt<span style="color: #555555">.</span>show()
</code></pre></div>

<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%;"><span></span><code>plot_learning_curves(history)
</code></pre></div>

<p><img alt="png" src="../output_40_0.png" /></p>
<h4 id="performing-inference">Performing Inference</h4>
<p>Call the model's <code>evaluate()</code> method, passing it the test set (<code>X_test</code> and <code>y_test</code>). This will compute the loss (cross-entropy) on the test set, as well as all the additional metrics (in this case, the accuracy). Your model should achieve over 80% accuracy on the test set.</p>
<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%;"><span></span><code>model<span style="color: #555555">.</span>evaluate(X_train, y_train)
</code></pre></div>

<div class="codehilite" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code>60000/60000 [==============================] - 1s 18us/sample - loss: 0.0519 - accuracy: 0.9872





[0.051851865920548634, 0.98723334]
</code></pre></div>

<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%;"><span></span><code>valid_0 <span style="color: #555555">=</span> X_valid[<span style="color: #FF6600">0</span>]<span style="color: #555555">.</span>reshape(<span style="color: #FF6600">1</span>, <span style="color: #FF6600">784</span>)
</code></pre></div>

<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%;"><span></span><code>model<span style="color: #555555">.</span>predict(valid_0)
</code></pre></div>

<div class="codehilite" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code>array([[2.8813774e-09, 3.8345047e-10, 1.1818415e-04, 2.0551306e-06,
        2.2122413e-11, 1.7986340e-09, 1.0651025e-13, 9.9987960e-01,
        1.7287803e-08, 1.0190855e-07]], dtype=float32)
</code></pre></div>

<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%;"><span></span><code>model<span style="color: #555555">.</span>predict_classes(valid_0)
</code></pre></div>

<div class="codehilite" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code>array([7])
</code></pre></div>

<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%;"><span></span><code>plt<span style="color: #555555">.</span>imshow(valid_0<span style="color: #555555">.</span>reshape(<span style="color: #FF6600">28</span>,<span style="color: #FF6600">28</span>))
</code></pre></div>

<div class="codehilite" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code>&lt;matplotlib.image.AxesImage at 0x1a478e6278&gt;
</code></pre></div>

<p><img alt="png" src="../output_47_1.png" /></p>
<p>Define <code>X_new</code> as the first 10 instances of the test set. Call the model's <code>predict()</code> method to estimate the probability of each class for each instance (for better readability, you may use the output array's <code>round()</code> method):</p>
<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%;"><span></span><code>n_new <span style="color: #555555">=</span> <span style="color: #FF6600">10</span>
X_new <span style="color: #555555">=</span> X_train[:n_new]
y_proba <span style="color: #555555">=</span> model<span style="color: #555555">.</span>predict(X_new)
y_proba<span style="color: #555555">.</span>round(<span style="color: #FF6600">2</span>)
</code></pre></div>

<div class="codehilite" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code>array([[0.  , 0.  , 0.  , 0.01, 0.  , 0.99, 0.  , 0.  , 0.  , 0.  ],
       [1.  , 0.  , 0.  , 0.  , 0.  , 0.  , 0.  , 0.  , 0.  , 0.  ],
       [0.  , 0.  , 0.01, 0.  , 0.99, 0.  , 0.  , 0.  , 0.  , 0.  ],
       [0.  , 1.  , 0.  , 0.  , 0.  , 0.  , 0.  , 0.  , 0.  , 0.  ],
       [0.  , 0.  , 0.  , 0.  , 0.  , 0.  , 0.  , 0.  , 0.  , 0.99],
       [0.  , 0.  , 1.  , 0.  , 0.  , 0.  , 0.  , 0.  , 0.  , 0.  ],
       [0.  , 1.  , 0.  , 0.  , 0.  , 0.  , 0.  , 0.  , 0.  , 0.  ],
       [0.  , 0.  , 0.  , 1.  , 0.  , 0.  , 0.  , 0.  , 0.  , 0.  ],
       [0.  , 1.  , 0.  , 0.  , 0.  , 0.  , 0.  , 0.  , 0.  , 0.  ],
       [0.  , 0.  , 0.  , 0.  , 1.  , 0.  , 0.  , 0.  , 0.  , 0.  ]],
      dtype=float32)
</code></pre></div>

<p>Often, you may only be interested in the most likely class. Use <code>np.argmax()</code> to get the class ID of the most likely class for each instance. <strong>Tip</strong>: you want to set <code>axis=1</code>.</p>
<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%;"><span></span><code>y_pred <span style="color: #555555">=</span> y_proba<span style="color: #555555">.</span>argmax(axis<span style="color: #555555">=</span><span style="color: #FF6600">1</span>)
y_pred
</code></pre></div>

<div class="codehilite" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code>array([5, 0, 4, 1, 9, 2, 1, 3, 1, 4])
</code></pre></div>

<p>Call the model's <code>predict_classes()</code> method for <code>X_new</code>. You should get the same result as above.</p>
<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%;"><span></span><code>y_pred <span style="color: #555555">=</span> model<span style="color: #555555">.</span>predict_classes(X_new)
y_pred
</code></pre></div>

<div class="codehilite" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code>array([5, 0, 4, 1, 9, 2, 1, 3, 1, 4])
</code></pre></div>

<p>(Optional) It is often useful to know how confident the model is for each prediction. Try finding the estimated probability for each predicted class using <code>np.max()</code>.</p>
<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%;"><span></span><code>y_proba<span style="color: #555555">.</span>max(axis<span style="color: #555555">=</span><span style="color: #FF6600">1</span>)<span style="color: #555555">.</span>round(<span style="color: #FF6600">2</span>)
</code></pre></div>

<div class="codehilite" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code>array([0.99, 1.  , 0.99, 1.  , 0.99, 1.  , 1.  , 1.  , 1.  , 1.  ],
      dtype=float32)
</code></pre></div>

<p>(Optional) It is frequent to want the top k classes and their estimated probabilities rather just the most likely class. You can use <code>np.argsort()</code> for this.</p>
<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%;"><span></span><code>k <span style="color: #555555">=</span> <span style="color: #FF6600">3</span>
top_k <span style="color: #555555">=</span> np<span style="color: #555555">.</span>argsort(<span style="color: #555555">-</span>y_proba, axis<span style="color: #555555">=</span><span style="color: #FF6600">1</span>)[:, :k]
top_k
</code></pre></div>

<div class="codehilite" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code>array([[5, 3, 1],
       [0, 5, 2],
       [4, 2, 7],
       [1, 2, 7],
       [9, 4, 7],
       [2, 8, 9],
       [1, 8, 3],
       [3, 9, 8],
       [1, 9, 7],
       [4, 5, 6]])
</code></pre></div>

<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%;"><span></span><code>row_indices <span style="color: #555555">=</span> np<span style="color: #555555">.</span>tile(np<span style="color: #555555">.</span>arange(<span style="color: #336666">len</span>(top_k)), [k, <span style="color: #FF6600">1</span>])<span style="color: #555555">.</span>T
y_proba[row_indices, top_k]<span style="color: #555555">.</span>round(<span style="color: #FF6600">2</span>)
</code></pre></div>

<div class="codehilite" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code>array([[0.99, 0.01, 0.  ],
       [1.  , 0.  , 0.  ],
       [0.99, 0.01, 0.  ],
       [1.  , 0.  , 0.  ],
       [0.99, 0.  , 0.  ],
       [1.  , 0.  , 0.  ],
       [1.  , 0.  , 0.  ],
       [1.  , 0.  , 0.  ],
       [1.  , 0.  , 0.  ],
       [1.  , 0.  , 0.  ]], dtype=float32)
</code></pre></div>

<div class="codehilite" style="background: #f0f3f3"><pre style="line-height: 125%;"><span></span><code>
</code></pre></div>

              
            </article>
          </div>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        
        <a href="../../clustering/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Clustering" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Clustering
            </div>
          </div>
        </a>
      
      
        
        <a href="../../feature/feature/" class="md-footer__link md-footer__link--next" aria-label="Next: Neural Network-FeatureScaling" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Neural Network-FeatureScaling
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../..", "features": [], "search": "../../assets/javascripts/workers/search.5e67fbfe.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.c44cc438.min.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
      
    
  </body>
</html>